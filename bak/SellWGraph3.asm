
*=$2000
        BYTE    60,102,110,110,96,98,60,0
        BYTE    24,60,102,126,102,102,102,0
        BYTE    124,102,102,124,102,102,124,0
        BYTE    60,102,96,96,96,102,60,0
        BYTE    120,108,102,102,102,108,120,0
        BYTE    126,96,96,120,96,96,126,0
        BYTE    126,96,96,120,96,96,96,0
        BYTE    60,102,96,110,102,102,60,0
        BYTE    102,102,102,126,102,102,102,0
        BYTE    60,24,24,24,24,24,60,0
        BYTE    30,12,12,12,12,108,56,0
        BYTE    102,108,120,112,120,108,102,0
        BYTE    96,96,96,96,96,96,126,0
        BYTE    99,119,127,107,99,99,99,0
        BYTE    102,118,126,126,110,102,102,0
        BYTE    60,102,102,102,102,102,60,0
        BYTE    124,102,102,124,96,96,96,0
        BYTE    60,102,102,102,102,60,14,0
        BYTE    124,102,102,124,120,108,102,0
        BYTE    60,102,96,60,6,102,60,0
        BYTE    126,24,24,24,24,24,24,0
        BYTE    102,102,102,102,102,102,60,0
        BYTE    102,102,102,102,102,60,24,0
        BYTE    99,99,99,107,127,119,99,0
        BYTE    102,102,60,24,60,102,102,0
        BYTE    102,102,102,60,24,24,24,0
        BYTE    126,6,12,24,48,96,126,0
        BYTE    60,48,48,48,48,48,60,0
        BYTE    12,18,48,124,48,98,252,0
        BYTE    60,12,12,12,12,12,60,0
        BYTE    0,24,60,126,24,24,24,24
        BYTE    0,16,48,127,127,48,16,0
        BYTE    0,0,0,0,0,0,0,0
        BYTE    24,24,24,24,0,0,24,0
        BYTE    102,102,102,0,0,0,0,0
        BYTE    102,102,255,102,255,102,102,0
        BYTE    24,62,96,60,6,124,24,0
        BYTE    98,102,12,24,48,102,70,0
        BYTE    60,102,60,56,103,102,63,0
        BYTE    6,12,24,0,0,0,0,0
        BYTE    12,24,48,48,48,24,12,0
        BYTE    48,24,12,12,12,24,48,0
        BYTE    0,102,60,255,60,102,0,0
        BYTE    0,24,24,126,24,24,0,0
        BYTE    0,0,0,0,0,24,24,48
        BYTE    0,0,0,126,0,0,0,0
        BYTE    0,0,0,0,0,24,24,0
        BYTE    0,3,6,12,24,48,96,0
        BYTE    60,102,110,118,102,102,60,0
        BYTE    24,24,56,24,24,24,126,0
        BYTE    60,102,6,12,48,96,126,0
        BYTE    60,102,6,28,6,102,60,0
        BYTE    6,14,30,102,127,6,6,0
        BYTE    126,96,124,6,6,102,60,0
        BYTE    60,102,96,124,102,102,60,0
        BYTE    126,102,12,24,24,24,24,0
        BYTE    60,102,102,60,102,102,60,0
        BYTE    60,102,102,62,6,102,60,0
        BYTE    0,0,24,0,0,24,0,0
        BYTE    0,0,24,0,0,24,24,48
        BYTE    14,24,48,96,48,24,14,0
        BYTE    0,0,126,0,126,0,0,0
        BYTE    112,24,12,6,12,24,112,0
        BYTE    60,102,6,12,24,0,24,0
        BYTE    0,0,0,255,255,0,0,0
        BYTE    8,28,62,127,127,28,62,0
        BYTE    24,24,24,24,24,24,24,24
        BYTE    0,0,0,255,255,0,0,0
        BYTE    0,0,255,255,0,0,0,0
        BYTE    0,255,255,0,0,0,0,0
        BYTE    0,0,0,0,255,255,0,0
        BYTE    48,48,48,48,48,48,48,48
        BYTE    12,12,12,12,12,12,12,12
        BYTE    0,0,0,224,240,56,24,24
        BYTE    24,24,28,15,7,0,0,0
        BYTE    24,24,56,240,224,0,0,0
        BYTE    192,192,192,192,192,192,255,255
        BYTE    192,224,112,56,28,14,7,3
        BYTE    3,7,14,28,56,112,224,192
        BYTE    255,255,192,192,192,192,192,192
        BYTE    255,255,3,3,3,3,3,3
        BYTE    255,255,255,251,243,227,195,131
        BYTE    0,0,0,0,0,255,255,0
        BYTE    54,127,127,127,62,28,8,0
        BYTE    96,96,96,96,96,96,96,96
        BYTE    0,0,0,7,15,28,24,24
        BYTE    195,231,126,60,60,126,231,195
        BYTE    0,60,126,102,102,126,60,0
        BYTE    24,24,102,102,24,24,60,0
        BYTE    6,6,6,6,6,6,6,6
        BYTE    8,28,62,127,62,28,8,0
        BYTE    24,24,24,255,255,24,24,24
        BYTE    192,192,48,48,192,192,48,48
        BYTE    24,24,24,24,24,24,24,24
        BYTE    0,0,3,62,118,54,54,0
        BYTE    255,127,63,31,15,7,3,1
        BYTE    0,0,0,0,0,0,0,0
        BYTE    240,240,240,240,240,240,240,240
        BYTE    0,0,0,0,255,255,255,255
        BYTE    255,0,0,0,0,0,0,0
        BYTE    100,138,138,74,42,42,196,0
        BYTE    140,138,138,138,138,138,236,0
        BYTE    204,204,51,51,204,204,51,51
        BYTE    3,3,3,3,3,3,3,3
        BYTE    0,0,0,0,204,204,51,51
        BYTE    255,254,252,248,240,224,192,128
        BYTE    3,3,3,3,3,3,3,3
        BYTE    24,24,24,31,31,24,24,24
        BYTE    0,0,0,0,15,15,15,15
        BYTE    24,24,24,31,31,0,0,0
        BYTE    0,0,0,248,248,24,24,24
        BYTE    0,0,0,0,0,0,255,255
        BYTE    0,0,0,31,31,24,24,24
        BYTE    24,24,24,255,255,0,0,0
        BYTE    0,0,0,255,255,24,24,24
        BYTE    24,24,24,248,248,24,24,24
        BYTE    192,192,192,192,192,192,192,192
        BYTE    224,224,224,224,224,224,224,224
        BYTE    7,7,7,7,7,7,7,7
        BYTE    255,255,0,0,0,0,0,0
        BYTE    255,255,255,0,0,0,0,0
        BYTE    0,0,0,0,0,255,255,255
        BYTE    3,3,3,3,3,3,255,255
        BYTE    0,0,0,0,240,240,240,240
        BYTE    0,174,168,170,238,0,64,128
        BYTE    24,40,88,60,26,24,36,36
        BYTE    24,8,90,60,24,24,36,36
        BYTE    0,24,24,60,90,24,36,36
        BYTE    195,153,145,145,159,153,195,255
        BYTE    231,195,153,129,153,153,153,255
        BYTE    131,153,153,131,153,153,131,255
        BYTE    195,153,159,159,159,153,195,255
        BYTE    135,147,153,153,153,147,135,255
        BYTE    129,159,159,135,159,159,129,255
        BYTE    129,159,159,135,159,159,159,255
        BYTE    195,153,159,145,153,153,195,255
        BYTE    153,153,153,129,153,153,153,255
        BYTE    195,231,231,231,231,231,195,255
        BYTE    225,243,243,243,243,147,199,255
        BYTE    153,147,135,143,135,147,153,255
        BYTE    159,159,159,159,159,159,129,255
        BYTE    156,136,128,148,156,156,156,255
        BYTE    153,137,129,129,145,153,153,255
        BYTE    195,153,153,153,153,153,195,255
        BYTE    131,153,153,131,159,159,159,255
        BYTE    195,153,153,153,153,195,241,255
        BYTE    131,153,153,131,135,147,153,255
        BYTE    195,153,159,195,249,153,195,255
        BYTE    129,231,231,231,231,231,231,255
        BYTE    153,153,153,153,153,153,195,255
        BYTE    153,153,153,153,153,195,231,255
        BYTE    156,156,156,148,128,136,156,255
        BYTE    153,153,195,231,195,153,153,255
        BYTE    153,153,153,195,231,231,231,255
        BYTE    129,249,243,231,207,159,129,255
        BYTE    195,207,207,207,207,207,195,255
        BYTE    243,237,207,131,207,157,3,255
        BYTE    195,243,243,243,243,243,195,255
        BYTE    255,231,195,129,231,231,231,231
        BYTE    255,239,207,128,128,207,239,255
        BYTE    255,255,255,255,255,255,255,255
        BYTE    231,231,231,231,255,255,231,255
        BYTE    153,153,153,255,255,255,255,255
        BYTE    153,153,0,153,0,153,153,255
        BYTE    231,193,159,195,249,131,231,255
        BYTE    157,153,243,231,207,153,185,255
        BYTE    195,153,195,199,152,153,192,255
        BYTE    249,243,231,255,255,255,255,255
        BYTE    243,231,207,207,207,231,243,255
        BYTE    207,231,243,243,243,231,207,255
        BYTE    255,153,195,0,195,153,255,255
        BYTE    255,231,231,129,231,231,255,255
        BYTE    255,255,255,255,255,231,231,207
        BYTE    255,255,255,129,255,255,255,255
        BYTE    255,255,255,255,255,231,231,255
        BYTE    255,252,249,243,231,207,159,255
        BYTE    195,153,145,137,153,153,195,255
        BYTE    231,231,199,231,231,231,129,255
        BYTE    195,153,249,243,207,159,129,255
        BYTE    195,153,249,227,249,153,195,255
        BYTE    249,241,225,153,128,249,249,255
        BYTE    129,159,131,249,249,153,195,255
        BYTE    195,153,159,131,153,153,195,255
        BYTE    129,153,243,231,231,231,231,255
        BYTE    195,153,153,195,153,153,195,255
        BYTE    195,153,153,193,249,153,195,255
        BYTE    255,255,231,255,255,231,255,255
        BYTE    255,255,231,255,255,231,231,207
        BYTE    241,231,207,159,207,231,241,255
        BYTE    255,255,129,255,129,255,255,255
        BYTE    143,231,243,249,243,231,143,255
        BYTE    195,153,249,243,231,255,231,255
        BYTE    255,255,255,0,0,255,255,255
        BYTE    247,227,193,128,128,227,193,255
        BYTE    231,231,231,231,231,231,231,231
        BYTE    255,255,255,0,0,255,255,255
        BYTE    255,255,0,0,255,255,255,255
        BYTE    255,0,0,255,255,255,255,255
        BYTE    255,255,255,255,0,0,255,255
        BYTE    207,207,207,207,207,207,207,207
        BYTE    243,243,243,243,243,243,243,243
        BYTE    255,255,255,31,15,199,231,231
        BYTE    231,231,227,240,248,255,255,255
        BYTE    231,231,199,15,31,255,255,255
        BYTE    63,63,63,63,63,63,0,0
        BYTE    63,31,143,199,227,241,248,252
        BYTE    252,248,241,227,199,143,31,63
        BYTE    0,0,63,63,63,63,63,63
        BYTE    0,0,252,252,252,252,252,252
        BYTE    255,195,129,129,129,129,195,255
        BYTE    255,255,255,255,255,0,0,255
        BYTE    201,128,128,128,193,227,247,255
        BYTE    159,159,159,159,159,159,159,159
        BYTE    255,255,255,248,240,227,231,231
        BYTE    60,24,129,195,195,129,24,60
        BYTE    255,195,129,153,153,129,195,255
        BYTE    231,231,153,153,231,231,195,255
        BYTE    249,249,249,249,249,249,249,249
        BYTE    247,227,193,128,193,227,247,255
        BYTE    231,231,231,0,0,231,231,231
        BYTE    63,63,207,207,63,63,207,207
        BYTE    231,231,231,231,231,231,231,231
        BYTE    255,255,252,193,137,201,201,255
        BYTE    0,128,192,224,240,248,252,254
        BYTE    255,255,255,255,255,255,255,255
        BYTE    15,15,15,15,15,15,15,15
        BYTE    255,255,255,255,0,0,0,0
        BYTE    0,255,255,255,255,255,255,255
        BYTE    255,255,255,255,255,255,255,0
        BYTE    63,63,63,63,63,63,63,63
        BYTE    51,51,204,204,51,51,204,204
        BYTE    252,252,252,252,252,252,252,252
        BYTE    255,255,255,255,51,51,204,204
        BYTE    0,1,3,7,15,31,63,127
        BYTE    252,252,252,252,252,252,252,252
        BYTE    231,231,231,224,224,231,231,231
        BYTE    255,255,255,255,240,240,240,240
        BYTE    231,231,231,224,224,255,255,255
        BYTE    255,255,255,7,7,231,231,231
        BYTE    255,255,255,255,255,255,0,0
        BYTE    255,255,255,224,224,231,231,231
        BYTE    231,231,231,0,0,255,255,255
        BYTE    255,255,255,0,0,231,231,231
        BYTE    231,231,231,7,7,231,231,231
        BYTE    63,63,63,63,63,63,63,63
        BYTE    31,31,31,31,31,31,31,31
        BYTE    248,248,248,248,248,248,248,248
        BYTE    0,0,255,255,255,255,255,255
        BYTE    0,0,0,255,255,255,255,255
        BYTE    255,255,255,255,255,0,0,0
        BYTE    252,252,252,252,252,252,0,0
        BYTE    255,255,255,255,15,15,15,15
        BYTE    0,0,0,0,0,0,0,0
        BYTE    0,88,154,124,24,24,36,36
        BYTE    24,8,24,60,90,24,36,36
        BYTE    0,24,24,60,60,24,24,24

*=$3000
; Truck right
 BYTE 170,170,0
 BYTE 170,170,160
 BYTE 175,254,144
 BYTE 191,255,144
 BYTE 191,255,144
 BYTE 191,255,169
 BYTE 191,255,170
 BYTE 170,170,170
 BYTE 85,169,86
 BYTE 65,85,5
 BYTE 60,84,240
 BYTE 60,0,240
 BYTE 60,0,240
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0

; Truck right
 BYTE 0,0,0
 BYTE 170,170,0
 BYTE 170,170,160
 BYTE 175,254,144
 BYTE 191,255,144
 BYTE 191,255,144
 BYTE 191,255,169
 BYTE 191,255,170
 BYTE 170,170,170
 BYTE 85,169,86
 BYTE 125,85,245
 BYTE 60,84,240
 BYTE 60,0,240
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0

; Truck right
 BYTE 170,170,0
 BYTE 170,170,160
 BYTE 175,254,144
 BYTE 191,255,144
 BYTE 191,255,144
 BYTE 191,255,169
 BYTE 191,255,170
 BYTE 170,170,170
 BYTE 85,169,86
 BYTE 125,85,245
 BYTE 60,84,240
 BYTE 60,0,240
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0

; 
 BYTE 0,0,170
 BYTE 0,2,170
 BYTE 0,10,170
 BYTE 0,42,170
 BYTE 0,170,138
 BYTE 2,170,10
 BYTE 10,168,10
 BYTE 42,160,10
 BYTE 42,160,43
 BYTE 21,224,175
 BYTE 21,226,156
 BYTE 42,170,64
 BYTE 170,169,0
 BYTE 170,164,0
 BYTE 105,128,0
 BYTE 170,192,0
 BYTE 195,192,0
 BYTE 195,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0

; 
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,128,0
 BYTE 2,0,0
 BYTE 1,0,0
 BYTE 1,1,0
 BYTE 50,5,0
 BYTE 6,16,0
 BYTE 2,80,0
 BYTE 1,0,0
 BYTE 5,0,0
 BYTE 16,0,0
 BYTE 80,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0,0,0
 BYTE 0

; 10 SYS (26112)

*=$0801

        BYTE    $0E, $08, $0A, $00, $9E, $20, $28,  $32, $36, $31, $31, $32, $29, $00, $00, $00



;Set variables;
Speed           byte 5
BakeTimer       byte 10
TruckType       byte 1
PassCount       byte 0
LineCount       byte 0
SaleCount       byte 0
LeftCount       byte 0
ManFrame        byte $7f
angryFrame      byte $7e
CookingCnt      byte 5
linepos         byte $1D,$1E,$1F,$20,$21,$22,$23,$24,$25

;Set Constants;
scnsrt          = #$0400
SPR_ROOT        = ($3000/64)
rand            = $d41b
leavchance      = #$e6

*=$6600
        LDA #$6F        ;This Part initalized noise channel for random
        LDY #$81        ;and lets us use lda $d41b to grab a random num
        LDX #$FF        ;between 0-255
        STA $D413 
        STY $D412 
        STX $D40E 
        STX $D40F 
        STX $D414 

        jsr $e544       ;clear screen
        lda #$18
        sta $d018       ;set char rom to $3800 and leave screen ram default
        lda #0              ;set screen black
        sta $D020
        sta $D021
        lda #1          ;set global sprite colour 1
        sta $d025
        lda #11         ;set global sprite colour 2
        sta $d026
        lda #5
        sta $d027       ;storesprite1 colour
        lda #3
        sta $d028       ;storesprite2 colour
        lda #
        lda #%00000011  ;turn on sprites
        sta $d015
        lda #%00000011  ;set sprite mode
        sta $d01c
        lda #%00000010  ;set sprite size
        sta $d017
        sta $d01d
        lda #SPR_ROOT+4
        sta $07f8
        lda #40
        sta $d002
        asl a
        sta $d003
        lda #SPR_ROOT+3
        sta $07f9
        lda #64
        sta $d000
        lda #86
        sta $d001
        
;start   lda ManFrame
;        sta $0400
;        lda #255
;        sta $0401
;        lda #%10000000
;        eor ManFrame
;        sta ManFrame
;        jmp start
        
newcust ldx     #17             ;number of times to run
        lda     #00
        sta     $fb             ;set zero page for start location
        lda     #$07            ;set high bit for start location
        sta     $fc
        ldy     #$e3            ;set low bit for start location
        sec                     ;set Carry for some math later
walkby  txs                     ;save x for when jsr returns
        jsr     delay2          ;slow it down so we can see it
        tsx                     ;load x back into x
        lda     #%10000000      ;reverse char mask
        eor     ManFrame        ;flip bit 8 for ManFrame
        sta     ManFrame        ;save it back on ManFrame
        lda     #$60            ;load " " into acc
        sta     ($fb),y         ;load it at the bottom of screen
        tya                     ;transfer y to accumulator then
        sbc     #40             ;subtract 40 (one line)
        tay                     ;save acc in y
        bcc     nxtbl           ;if math cleared carry we need to move up one high bit
wlkrtn  lda     ManFrame        ;otherwise we are good to place next man frame
        sta     ($fb),y         ;at this screen location
        dex                     
        bne     walkby          ;next loop
        jmp     checkstop       
nxtbl   dec     $fc             ;decrease high bit for screen location
        sec
        jmp     wlkrtn

checkstop   
        lda     rand   ;do they stop?
        cmp     #$7f
        bcc     leave

lineup  lda     #10             ;set line max size
        cmp     LineCount       ;check if line full
        bcc     leave           ;if so leave
        inc     LineCount       ;if not inc linecount
        lda     #30            ;distance to start of line
        sbc     LineCount       ;less number of people in line
        tax                     ;set number of loops
        ldy     #30             ;set travel distance
linelp  txs                     ;save x for when jsr returns
        jsr     delay2          ;slow it down so we can see it
        tsx                     ;load x back into x
        lda     #%10000000      ;reverse char mask
        eor     ManFrame        ;flip bit 8 for ManFrame
        sta     ManFrame        ;save it back on ManFrame
        lda     #$60            ;load " " into acc
        sta     $051D,y         ;store at line start +x
        lda     ManFrame        ;load Man Chr into acc
        dey
        sta     $051D,y         ;store at line start +x
        dex
        bne     linelp
        
        jmp     angry


        
leave   ldx     #7             ;number of times to run
        lda     #00
        sta     $fb             ;set zero page for start location
        lda     #$05            ;set high bit for start location
        sta     $fc
        ldy     #$3B            ;set low bit for start location
        sec                     ;set Carry for some math later
leaving txs                     ;save x for when jsr returns
        jsr     delay2          ;slow it down so we can see it
        tsx                     ;load x back into x
        lda     #%10000000      ;reverse char mask
        eor     ManFrame        ;flip bit 8 for ManFrame
        sta     ManFrame        ;save it back on ManFrame
        lda     #$60            ;load " " into acc
        sta     ($fb),y         ;load it at the bottom of screen
        tya                     ;transfer y to accumulator then
        sbc     #40             ;subtract 40 (one line)
        tay                     ;save acc in y
        bcc     nxtll           ;if math cleared carry we need to move up one high bit
lvertn  lda     ManFrame        ;otherwise we are good to place next man frame
        sta     ($fb),y         ;at this screen location
        dex                     
        bne     leaving          ;next loop
        jsr     delay2
        lda     #$60
        sta     $0423
        jmp     angry       
nxtll   dec     $fc             ;decrease high bit for screen location
        sec
        jmp     lvertn

linefix inc     $0400+2
        jmp     newcust

angry   ldx     #4              ;reset x        here we are checking if they mad 
        ldy     #0
lvelp   lda     $051D,x         ;grab character at line pos 1
        cmp     #96            ;check if it's a space
        beq     linefix        
        lda     rand
        cmp     $7f
        bcc     gonedy
        sta     $0400+0
        inx     
        cmp     #10
        bne     linefix
        jmp     lvelp

gonedy  lda     #00
        sta     $fb             ;set zero page for start location
        lda     #$05            ;set high bit for start location
        sta     $fc
        ldy     linepos,x            ;set low bit for start location
        sec                     ;set Carry for some math later
        lda     angryFrame
        sta     ($fb),y
        lda     #%10000000      ;reverse char mask
        eor     angryFrame      ;flip bit 8 for ManFrame
        sta     angryFrame      ;save it back on ManFrame
        tya                     ;transfer y to accumulator then
        sbc     #39             ;subtract 39 (up and rig
        bcc     decline           ;if math cleared carry we need to move up one high bit
gnrtn   lda     #124            ;otherwise we are good to place ug 
        sta     ($fb),y         ;at this screen location
        sta     $0400+8
        ldx     #40
        jsr     delayx
        lda     #60             ;wait then get rid of ug
        sta     ($fb),y         ;at this screen location   
        ldx     #40
        tya     
        ldx     #7
        sec                     ;set Carry for some math later
goneing txs                     ;save x for when jsr returns
        jsr     delay2          ;slow it down so we can see it
        tsx                     ;load x back into x
        lda     #%10000000      ;reverse char mask
        eor     angryFrame        ;flip bit 8 for ManFrame
        sta     angryFrame      ;save it back on ManFrame
        lda     #$60            ;load " " into acc
        sta     ($fb),y         ;load it at the bottom of screen
        tya                     ;transfer y to accumulator then
        sbc     #40             ;subtract 40 (one line)
        tay                     ;save acc in y
        bcc     decline2           ;if math cleared carry we need to move up one high bit
gnrtn2  lda     angryFrame       ;otherwise we are good to place next man frame
        sta     ($fb),y         ;at this screen location
        dex                     
        bne     goneing          ;next loop
        jsr     delay2
        lda     #$60
        sta     $0423
        jmp     angry       
decline2
        dec     $fc             ;decrease high bit for screen location
        sec
        jmp     gnrtn2
        jmp     newcust
decline
        dec     $fc             ;decrease high bit for screen location
        sec
        jmp     gnrtn
        

delay   lda     $d012
        cmp     #$ff
        bne     delay
        rts

delay2  ldx     #10
dlp     lda     $d012
        cmp     #$ff
        bne     dlp
        dex
        bne     dlp
        rts

delayx  lda     $d012
        cmp     #$ff
        bne     dlp
        dex
        bne     delayx
        rts